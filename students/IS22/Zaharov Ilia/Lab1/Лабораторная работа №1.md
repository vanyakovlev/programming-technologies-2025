# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1. –û—Ç—á—ë—Ç.
## –ü–ª–∞–Ω –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è;
2. –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ OpenAI Responses API;
3. –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª;
4. Troubleshooting;
5. –ó–∞–¥–∞–Ω–∏—è.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–æ–¥–∞
–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—á–∞—è –æ–±–ª–∞—Å—Ç—å —Å –≤–∏—Ä—É—Ç—É–∞–ª—å–Ω—ã–º –æ—Ä–∫—É–∂–µ–Ω–∏–µ–º. –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤–µ—Ä—Å–∏–∏ —Ä–∞–∑–Ω—ã–π Python-–±–∏–±–ª–∏–æ—Ç–µ–∫ –Ω–µ —Å–º–µ—à–∏–≤–∞–ª–∏—Å—å –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –∏ –º–æ–∂–Ω–æ –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ –æ—Ç–¥–µ–ª—è—Ç—å –æ–¥–Ω–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö. –í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫, —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã: ``pip frezee > "requirements.txt"`` –±—ã–ª —Å–æ–∑–¥–∞–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏.

### –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å OpenAI
–ü—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–µ —Å–¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ API OpenAI, —è —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π, —á—Ç–æ —Å —ç—Ç–∏–º API –Ω–µ–ª—å–∑—è —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ:

![–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ OpenAI](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image1.png)

–ë—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π. –ü–æ—Å–ª–µ –ø—Ä–æ–± –º–Ω–æ–≥–∏—Ö –≤–∞—Ä–∏–Ω–∞—Ç–æ–≤ —Ç–∞–∫–∏—Ö –∫–∞–∫: Huggingface, ai.io.net, Google –∏ —Ç.–¥. –≤—ã–±–æ—Ä –ø–∞–ª –Ω–∞ API –æ—Ç Mistral. –ï—ë –ø–ª—é—Å –≤ —Ç–æ–º, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç Mistral –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π OpenAI, —Ç–æ –µ—Å—Ç—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –Ω–æ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –Ω–µ –ø—Ä–∏—à–ª–æ—Å—å. –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –±—ã–ª —Å–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–≥ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:

![–£—Å–ø–µ—â–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º Mistral](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image2.png)

–î–∞–ª–µ–µ –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –∑–∞–¥–∞–Ω–∏—è–º –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–æ–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

## –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1
–ü–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∑–≤—É—á–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:\
``–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è .env, –ª–∏–±–æ —á–µ—Ä–µ–∑ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥/–≤—ã–±–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ –∏ –µ–≥–æ —Å–æ—Ö—Ä–∞–Ω–∏–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –æ–ø—Ü–∏–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ``

–î–ª—è –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ ``.env`` —Ñ–∞–π–ª –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è ``SYSTEM_PROMPT``. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–Ω–∞ –ø–æ–¥–≥—Ä—É–∂–∞–ª–∞—Å—å –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ–Ω–∏–º–∞–ª, –∫–∞–∫ –µ–º—É –Ω—É–∂–Ω–æ —Å–µ–±—è –≤–µ—Å—Ç–∏.
–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ–≥–æ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ–¥ –±—ã–ª –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω—ë–Ω. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ``SqlLite``, —Ç.–∫. –æ–Ω–∞ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –∏ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫ —ç—Ç–∞. –ü–æ –∏—Ç–æ–≥—É, –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –≤—ã–≥–ª—è–¥–∏—Ç –≤–æ—Ç —Ç–∞–∫:

![–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —á–µ—Ä–µ–∑ .env —Ñ–∞–π–ª](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image3.png)

–¢–æ –µ—Å—Ç—å –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –≤ .env —Ñ–∞–π–ª–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –æ–Ω–∞ –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Ç–æ–º, —Ö–æ—á–µ—Ç –ª–∏ –æ–Ω –≤–≤–µ—Å—Ç–∏/–ø–æ–º–µ–Ω—è—Ç—å –µ–≥–æ, –∞ –≤–æ—Ç –µ—Å–ª–∏ –≤ .env —Ñ–∞–π–ª–µ –µ–≥–æ –Ω–µ—Ç, —Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–µ–Ω—è–µ—Ç—Å—è:

![–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –≤ .env —Ñ–∞–π–ª–µ](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image4.png)

![–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image5.png)
## –ó–∞–¥–∞–Ω–∏–µ ‚Ññ2
–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã–ª–æ –ø–æ–∏–≥—Ä–∞—Ç—å—Å—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ``temperature`` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –µ—ë –ø–æ–≤–µ–¥–µ–Ω–∏–µ. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±—ã–ª –≤—ã–±—Ä–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å: ``–ö–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å —Å–∞–ª–∞—Ç –û–ª–∏–≤—å–µ?``. –°–Ω–∞—á–∞–ª–∞, –±—ã–ª–æ –≤—ã–±—Ä–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ temperature —Ä–∞–≤–Ω–æ–µ 0.1 –∏ –≤–æ—Ç –∫–∞–∫ –æ—Ç–≤–µ—Ç–∏–ª –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç:

![–û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –ø—Ä–∏ temperature=0.1](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image6.png)

–ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –æ—Ç–≤–µ—Ç–∞, –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–≤–µ—Ç–∏–ª –±–µ–∑ —Ñ–∞–Ω—Ç–∞–∑–∏–∏, —á—ë—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É. –î–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä temperature –±—ã–ª –ø–æ–¥–Ω—è—Ç –¥–æ –∑–Ω–∞—á–µ–Ω–∏—è 1.3, –∏ –≤–æ—Ç –∫–∞–∫ –Ω–∞ —ç—Ç–æ –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç:

![–û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –ø—Ä–∏ temperature=1.3](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image7.png)

–í–∏–¥–Ω–æ, —á—Ç–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, –º—è–≥–∫–æ –≥–æ–≤–æ—Ä—è, –Ω–∞—á–∞–ª "—á—É–¥–∏—Ç—å" –∏ –≤—ã–¥–∞–≤–∞–ª –Ω–µ —Å–≤—è–∑–Ω—ã–π –æ—Ç–≤–µ—Ç, –∏ –¥–∞–∂–µ –ø–æ —Ö–æ–¥—É –æ—Ç–≤–µ—Ç–∞ –º–µ–Ω—è–ª —è–∑—ã–∫.
## –ó–∞–¥–∞–Ω–∏–µ ‚Ññ3
–°—É—Ç—å –∑–∞–¥–∞–Ω–∏—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞—É—á–∏—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –ø–æ–º–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –µ—ë –¥–æ 6 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π: 3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö, 3 –ò–ò—à–Ω—ã—Ö. –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è —Å–Ω–æ–≤–∞ –ø—Ä–∏—à–ª–æ—Å—å –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–¥. –ë—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ 2 –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã: ``show_history`` –∏ ``clear_history``, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏ –æ—á–∏—â–∞—Ç—å –µ—ë. –í–æ—Ç –∫–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:

![–ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image8.png)

![–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image9.png)

![–û–±—â–µ–Ω–∏–µ —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –ø—Ä–∏ –∏—Å—Ç–æ—Ä–∏–∏](https://github.com/NP1R777/programming-technologies-2025/blob/main/students/IS22/Zaharov%20Ilia/Lab1/pictures/image10.png)
## –í—ã–≤–æ–¥
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –∑–Ω–∞–Ω–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å API Mistral, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞.
## –õ–∏—Å—Ç–∏–Ω–≥ –∫–æ–¥–∞
```
import os
import sqlite3
from openai import OpenAI
from dotenv import load_dotenv

load_dotenv()

api_key = os.getenv("MISTRAL_API_KEY")

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
client = OpenAI(
    api_key=api_key,
    base_url="https://api.mistral.ai/v1"
)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def init_db():
    conn = sqlite3.connect('prompts.db')
    cursor = conn.cursor()
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS prompts (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            name TEXT NOT NULL,
            prompt_text TEXT NOT NULL,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    ''')
    conn.commit()
    conn.close()

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º—Ç–∞ –≤ –±–∞–∑—É
def save_prompt_to_db(name, prompt_text):
    conn = sqlite3.connect('prompts.db')
    cursor = conn.cursor()
    cursor.execute('INSERT INTO prompts (name, prompt_text) VALUES (?, ?)', (name, prompt_text))
    conn.commit()
    conn.close()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–º—Ç–æ–≤ –∏–∑ –±–∞–∑—ã
def get_all_prompts():
    conn = sqlite3.connect('prompts.db')
    cursor = conn.cursor()
    cursor.execute('SELECT id, name, prompt_text FROM prompts ORDER BY created_at DESC')
    prompts = cursor.fetchall()
    conn.close()
    return prompts

# –í—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞
def select_system_prompt():
    env_prompt = os.getenv("SYSTEM_PROMPT")
    if env_prompt:
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç –∏–∑ .env: {env_prompt[:50]}...")
        return env_prompt
    
    print("\n" + "="*50)
    print("ü§ñ –í—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞")
    print("1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—Ä–æ–º—Ç")
    print("2. –í—ã–±—Ä–∞—Ç—å –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö")
    print("3. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π")
    print("4. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞")
    
    choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç (1-4): ").strip()
    
    if choice == "1":
        prompt = "–¢—ã - –ø–æ–ª–µ–∑–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –û—Ç–≤–µ—á–∞–π –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Ç–æ—á–Ω–æ –∏ –≤–µ–∂–ª–∏–≤–æ."
        save_option = input("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–º—Ç –≤ –±–∞–∑—É? (y/n): ").strip().lower()
        if save_option == 'y':
            name = input("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–º—Ç–∞: ").strip()
            save_prompt_to_db(name, prompt)
        return prompt
    
    elif choice == "2":
        prompts = get_all_prompts()
        if not prompts:
            print("‚ùå –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–º—Ç–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π.")
            return select_system_prompt()
        
        print("\n–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–º—Ç—ã:")
        for i, (id, name, text) in enumerate(prompts, 1):
            print(f"{i}. {name}: {text[:50]}...")
        
        try:
            prompt_num = int(input("\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –ø—Ä–æ–º—Ç–∞: ")) - 1
            if 0 <= prompt_num < len(prompts):
                return prompts[prompt_num][2]
            else:
                print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä")
                return select_system_prompt()
        except ValueError:
            print("‚ùå –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ")
            return select_system_prompt()
    
    elif choice == "3":
        print("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç:")
        prompt = input().strip()
        if prompt:
            name = input("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–º—Ç–∞: ").strip()
            save_prompt_to_db(name, prompt)
            return prompt
        else:
            print("‚ùå –ü—Ä–æ–º—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
            return select_system_prompt()
    
    elif choice == "4":
        return None
    
    else:
        print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä")
        return select_system_prompt()

def get_response(text: str, client: OpenAI, model: str = "mistral-tiny", 
                system_prompt: str = None, chat_history: list = None):
    try:
        messages = []
        
        if system_prompt:
            messages.append({"role": "system", "content": system_prompt})
        
        if chat_history:
            messages.extend(chat_history)
        
        messages.append({"role": "user", "content": text})
        
        response = client.chat.completions.create(
            model=model,
            messages=messages,
            max_tokens=1000,
            temperature=1.3
        )
        return response.choices[0].message.content
    except Exception as e:
        return f"–û—à–∏–±–∫–∞: {e}"

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–æ 6 —Å–æ–æ–±—â–µ–Ω–∏–π
def limit_history(history: list, max_messages: int = 6) -> list:
    """
    –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–æ–±—â–µ–Ω–∏–π.
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞.
    """
    if len(history) <= max_messages:
        return history
    
    return history[-max_messages:]

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ç–µ–∫—É—â–µ–π –∏—Å—Ç–æ—Ä–∏–∏
def show_history(chat_history: list):
    if not chat_history:
        print("–ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –ø—É—Å—Ç–∞")
        return
    
    print("\n" + "="*50)
    print("üìú –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞:")
    for i, message in enumerate(chat_history, 1):
        role = "–í—ã" if message["role"] == "user" else "Mistral"
        print(f"{i}. {role}: {message['content'][:100]}{'...' if len(message['content']) > 100 else ''}")
    print(f"–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {len(chat_history)}")
    print("="*50)

if __name__ == "__main__":
    init_db()
    
    system_prompt = select_system_prompt()
    
    print("=" * 50)
    print("ü§ñ Mistral AI Chat")
    print("–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏: mistral-tiny, mistral-small, mistral-medium")
    print("–í–≤–µ–¥–∏—Ç–µ 'exit' –¥–ª—è –≤—ã—Ö–æ–¥–∞")
    print("–í–≤–µ–¥–∏—Ç–µ 'model –Ω–∞–∑–≤–∞–Ω–∏–µ_–º–æ–¥–µ–ª–∏' –¥–ª—è —Å–º–µ–Ω—ã –º–æ–¥–µ–ª–∏")
    print("–í–≤–µ–¥–∏—Ç–µ 'reset_prompt' –¥–ª—è —Å–º–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞")
    print("–í–≤–µ–¥–∏—Ç–µ 'show_prompt' –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞")
    print("–í–≤–µ–¥–∏—Ç–µ 'show_history' –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞")
    print("–í–≤–µ–¥–∏—Ç–µ 'clear_history' –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞")
    print("=" * 50)
    
    current_model = "mistral-tiny"
    chat_history = []
    
    while True:
        try:
            question = input("\n–í—ã: ").strip()
            
            if question.lower() == "exit":
                print("–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
                break
            elif question.lower().startswith("model "):
                new_model = question[6:].strip()
                available_models = ["mistral-tiny", "mistral-small", "mistral-medium"]
                if new_model in available_models:
                    current_model = new_model
                    print(f"‚úÖ –ú–æ–¥–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞: {current_model}")
                else:
                    print(f"‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –º–æ–¥–µ–ª—å. –î–æ—Å—Ç—É–ø–Ω—ã–µ: {', '.join(available_models)}")
                continue
            elif question.lower() == "reset_prompt":
                system_prompt = select_system_prompt()
                chat_history = []
                continue
            elif question.lower() == "show_prompt":
                if system_prompt:
                    print(f"–¢–µ–∫—É—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç: {system_prompt}")
                else:
                    print("–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
                continue
            elif question.lower() == "show_history":
                show_history(chat_history)
                continue
            elif question.lower() == "clear_history":
                chat_history = []
                print("‚úÖ –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ –æ—á–∏—â–µ–Ω–∞")
                continue
            elif not question:
                continue
                
            print("Mistral: ", end="", flush=True)
            
            answer = get_response(question, client, current_model, system_prompt, chat_history)
            print(answer)
            
            chat_history.append({"role": "user", "content": question})
            chat_history.append({"role": "assistant", "content": answer})
            
            chat_history = limit_history(chat_history, 6)
            
        except KeyboardInterrupt:
            print("\n\n–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break
        except Exception as e:
            print(f"\n‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
```
